<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>万能搜索引擎</title>
    <link rel="icon" href="./favicon.ico" />
  </head>
  <style>
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background-image: url("./bg.jpg");
      color: white;
      font-size: large;
    }
  </style>
  <body>
    <div style="display: flex; color: gray">
      <p1 id="day">2000-01-01</p1>
      <p1 id="time" style="margin-left: 16px">00:00:00</p1>
    </div>
    <h1 style="margin-top: 30px">万能搜索引擎</h1>
    <div>
      <div>
        <input
          type="text"
          placeholder="Hello!"
          id="typeBox"
          style="width: 466px"
        />
        <span onclick="go()" style="margin-left: 10px">前往</span>
      </div>
      <div style="margin-top: 10px">
        <form id="form">
          <label for="search">
            <input
              type="radio"
              id="baidu"
              name="search"
              value="baidu"
              checked
            />
            百度
            <br />
            <input type="radio" id="google" name="search" value="google" />
            谷歌
            <br />
            <input type="radio" id="bing" name="search" value="bing" />
            必应
            <br />
            <input type="radio" id="360" name="search" value="360" />
            360
            <br />
            <input type="radio" id="soGou" name="search" value="soGou" />
            搜狗
            <br />
            <input type="radio" id="biliBili" name="search" value="biliBili" />
            哔哩哔哩
            <br />
            <input
              type="radio"
              id="baiDuHanYu"
              name="search"
              value="baiDuHanYu"
            />
            百度汉语
            <br />
            <input type="radio" id="youDao" name="search" value="youDao" />
            有道
            <br />
            <input
              type="radio"
              id="baiDuFanYi"
              name="search"
              value="baiDuFanYi"
            />
            百度翻译
            <br />
            <input type="radio" id="others" name="search" value="others" />
            其他（请填写URL及表单关键字）：
            <input
              type="text"
              placeholder="https://www.baidu.com/s?wd="
              id="othersValue"
              style="width: 200px"
              onclick="turnOther()"
            />
          </label>
        </form>
      </div>
    </div>
    <div
      style="
        display: flex;
        color: gray;
        margin-top: 30px;
        justify-content: space-between;
        width: 525.89px;
      "
    >
      <p1 id="open">今日开机时间：00:00:00</p1>
      <p1 id="toNow" style="margin-left: 16px">已开机：00:00:00</p1>
    </div>
  </body>
  <script>
    function cache() {
      let before = document.getElementById("typeBox").value;
      setTimeout(() => {
        let after = document.getElementById("typeBox").value;
        if (before != after) {
          radio = document.getElementById("form");
          if (isEnglish(after)) {
            radio[7].checked = true;
          } else {
            radio[0].checked = true;
          }
        }
        cache();
      }, 1000);
    }
    function getValue() {
      let radio = document.getElementsByName("search");
      for (i = 0; i < radio.length; i++) {
        if (radio[i].checked) {
          return radio[i].value;
        }
      }
    }
    function isEnglish(typeBox) {
      for (let i = 0; i < typeBox.length; i++) {
        if (!(typeBox[i] >= "a" && typeBox[i] <= "z")) {
          return false;
        }
      }
      return true;
    }
    function go() {
      let typeBox = document.getElementById("typeBox").value;
      let choose = getValue();
      let url;
      switch (choose) {
        case "baidu":
          url = "https://www.baidu.com/s?wd=" + typeBox;
          break;
        case "google":
          url = "https://www.soumao.cc/search?q=" + typeBox;
          break;
        case "bing":
          url = "https://cn.bing.com/search?q=" + typeBox;
          break;
        case "360":
          url = "https://www.so.com/s?q=" + typeBox;
          break;
        case "youDao":
          url = "http://www.youdao.com/w/eng/" + typeBox;
          break;
        case "baiDuFanYi":
          url = "https://fanyi.baidu.com/#en/zh/" + typeBox;
          break;
        case "soGou":
          url = "http://www.sogou.com/web?query=" + typeBox;
          break;
        case "biliBili":
          url = "https://search.bilibili.com/all?keyword=" + typeBox;
          break;
        case "baiDuHanYu":
          url = "https://hanyu.baidu.com/s?wd=" + typeBox;
          break;
        default:
          url = document.getElementById("othersValue").value + typeBox;
          break;
      }
      window.open(url);
    }
    window.onkeydown = function (event) {
      if (event.keyCode === 13) {
        go();
      }
    };
    function turnOther() {
      radio = document.getElementById("form");
      radio[9].checked = true;
    }
    cache();
    time();
    getDifference();
    function getDayTime() {
      let date = new Date();
      let year = date.getFullYear();
      let month = date.getMonth() + 1;
      let day = date.getDate();
      let dayTime = year + "-" + this.addZero(month) + "-" + this.addZero(day);
      return dayTime;
    }
    function getSecondTime() {
      let date = new Date();
      let hour = date.getHours();
      let minute = date.getMinutes();
      let second = date.getSeconds();
      let secondTime =
        this.addZero(hour) +
        ":" +
        this.addZero(minute) +
        ":" +
        this.addZero(second);
      return secondTime;
    }
    function time() {
      document.getElementById("day").innerHTML = getDayTime();
      document.getElementById("time").innerHTML = getSecondTime();
      setTimeout(() => {
        time();
      }, 1000);
    }
    function addZero(time) {
      return time < 10 ? "0" + time : time;
    }
    if (window.localStorage.getItem("day") != getDayTime()) {
      console.log("new");
      window.localStorage.setItem("day", getDayTime());
      window.localStorage.setItem("time", getSecondTime());
    }
    document.getElementById("open").innerHTML =
      "今日开机时间：" + window.localStorage.getItem("time");
    function getDifference() {
      let date = new Date();
      let open =
        window.localStorage.getItem("day") +
        " " +
        window.localStorage.getItem("time");
      let opentime = new Date(open.replace(/-/g, "/"));
      let times = date.getTime() - opentime.getTime();
      let h = parseInt(times / (3600 * 1000));
      let m = parseInt((times % (3600 * 1000)) / (60 * 1000));
      let s = parseInt(((times % (3600 * 1000)) % (60 * 1000)) / 1000);
      document.getElementById("toNow").innerHTML =
        "已开机：" + addZero(h) + ":" + addZero(m) + ":" + addZero(s);
      setTimeout(() => {
        getDifference();
      }, 1000);
    }
  </script>
</html>
